<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Overview of statistical analysis methods | Human Islets</title>
  <meta name="description" content="This is an introduction of the Human Islet project." />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Overview of statistical analysis methods | Human Islets" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is an introduction of the Human Islet project." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Overview of statistical analysis methods | Human Islets" />
  
  <meta name="twitter:description" content="This is an introduction of the Human Islet project." />
  

<meta name="author" content="" />


<meta name="date" content="2024-05-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="overview-of-omics-data-types.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Human Islets</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> General Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#land-acknowledgement"><i class="fa fa-check"></i><b>1.1</b> Land Acknowledgement</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#terms-of-use"><i class="fa fa-check"></i><b>1.2</b> Terms of Use</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#financial-support"><i class="fa fa-check"></i><b>1.3</b> Financial Support</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#overview-and-sampledata-collection"><i class="fa fa-check"></i><b>1.4</b> Overview and Sample/data Collection</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="using-humanislets.html"><a href="using-humanislets.html"><i class="fa fa-check"></i><b>2</b> Using HumanIslets.com</a>
<ul>
<li class="chapter" data-level="2.1" data-path="using-humanislets.html"><a href="using-humanislets.html#omics-data-analysis"><i class="fa fa-check"></i><b>2.1</b> Omics Data Analysis <img src="logo1.png" alt="Logo" style="width:18px; height:18px;"></a></li>
<li class="chapter" data-level="2.2" data-path="using-humanislets.html"><a href="using-humanislets.html#donor-view"><i class="fa fa-check"></i><b>2.2</b> Donor View <img src="logo2.png" alt="Logo" style="width:18px; height:18px;"></a></li>
<li class="chapter" data-level="2.3" data-path="using-humanislets.html"><a href="using-humanislets.html#feature-search"><i class="fa fa-check"></i><b>2.3</b> Feature Search <img src="logo3.png" alt="Logo" style="width:18px; height:18px;"></a></li>
<li class="chapter" data-level="2.4" data-path="using-humanislets.html"><a href="using-humanislets.html#data-download"><i class="fa fa-check"></i><b>2.4</b> Data download <img src="logo4.png" alt="Logo" style="width:18px; height:18px;"></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="overview-of-primary-metadata.html"><a href="overview-of-primary-metadata.html"><i class="fa fa-check"></i><b>3</b> Overview of Primary Metadata</a>
<ul>
<li class="chapter" data-level="3.1" data-path="overview-of-primary-metadata.html"><a href="overview-of-primary-metadata.html#donor-characteristics"><i class="fa fa-check"></i><b>3.1</b> Donor Characteristics</a></li>
<li class="chapter" data-level="3.2" data-path="overview-of-primary-metadata.html"><a href="overview-of-primary-metadata.html#organ-characteristics-and-processing"><i class="fa fa-check"></i><b>3.2</b> Organ Characteristics and Processing</a></li>
<li class="chapter" data-level="3.3" data-path="overview-of-primary-metadata.html"><a href="overview-of-primary-metadata.html#isolation-outcomes"><i class="fa fa-check"></i><b>3.3</b> Isolation Outcomes</a></li>
<li class="chapter" data-level="3.4" data-path="overview-of-primary-metadata.html"><a href="overview-of-primary-metadata.html#cell-type-proportions"><i class="fa fa-check"></i><b>3.4</b> Cell Type Proportions</a></li>
<li class="chapter" data-level="3.5" data-path="overview-of-primary-metadata.html"><a href="overview-of-primary-metadata.html#cell-culture-outcomes"><i class="fa fa-check"></i><b>3.5</b> Cell Culture Outcomes</a></li>
<li class="chapter" data-level="3.6" data-path="overview-of-primary-metadata.html"><a href="overview-of-primary-metadata.html#static-insulin-secretion"><i class="fa fa-check"></i><b>3.6</b> Static Insulin Secretion</a></li>
<li class="chapter" data-level="3.7" data-path="overview-of-primary-metadata.html"><a href="overview-of-primary-metadata.html#islet-oxygen-consumption-seahorse-assay"><i class="fa fa-check"></i><b>3.7</b> Islet Oxygen Consumption (Seahorse assay)</a></li>
<li class="chapter" data-level="3.8" data-path="overview-of-primary-metadata.html"><a href="overview-of-primary-metadata.html#dynamic-insulin-responses-to-macronutrients"><i class="fa fa-check"></i><b>3.8</b> Dynamic Insulin Responses to Macronutrients</a></li>
<li class="chapter" data-level="3.9" data-path="overview-of-primary-metadata.html"><a href="overview-of-primary-metadata.html#single-cell-function-electrophysiology"><i class="fa fa-check"></i><b>3.9</b> Single-cell Function (electrophysiology)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="overview-of-omics-data-types.html"><a href="overview-of-omics-data-types.html"><i class="fa fa-check"></i><b>4</b> Overview of Omics Data Types</a>
<ul>
<li class="chapter" data-level="4.1" data-path="overview-of-omics-data-types.html"><a href="overview-of-omics-data-types.html#gene-expression-bulk-rna-seq"><i class="fa fa-check"></i><b>4.1</b> Gene expression (bulk RNA-seq)</a></li>
<li class="chapter" data-level="4.2" data-path="overview-of-omics-data-types.html"><a href="overview-of-omics-data-types.html#gene-expression-nanostring"><i class="fa fa-check"></i><b>4.2</b> Gene expression (Nanostring)</a></li>
<li class="chapter" data-level="4.3" data-path="overview-of-omics-data-types.html"><a href="overview-of-omics-data-types.html#protein-expression-proteomics"><i class="fa fa-check"></i><b>4.3</b> Protein expression (proteomics)</a></li>
<li class="chapter" data-level="4.4" data-path="overview-of-omics-data-types.html"><a href="overview-of-omics-data-types.html#gene-expression-pseudobulk-rna-seq"><i class="fa fa-check"></i><b>4.4</b> Gene expression (pseudobulk RNA-seq)</a></li>
<li class="chapter" data-level="4.5" data-path="overview-of-omics-data-types.html"><a href="overview-of-omics-data-types.html#single-cell-gene-expression-patch-seq"><i class="fa fa-check"></i><b>4.5</b> Single-cell gene expression (patch-seq)</a></li>
<li class="chapter" data-level="4.6" data-path="overview-of-omics-data-types.html"><a href="overview-of-omics-data-types.html#single-cell-rna-seq"><i class="fa fa-check"></i><b>4.6</b> Single-cell RNA-seq</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="overview-of-statistical-analysis-methods.html"><a href="overview-of-statistical-analysis-methods.html"><i class="fa fa-check"></i><b>5</b> Overview of statistical analysis methods</a>
<ul>
<li class="chapter" data-level="5.1" data-path="overview-of-statistical-analysis-methods.html"><a href="overview-of-statistical-analysis-methods.html#multiple-linear-regression"><i class="fa fa-check"></i><b>5.1</b> Multiple linear regression</a></li>
<li class="chapter" data-level="5.2" data-path="overview-of-statistical-analysis-methods.html"><a href="overview-of-statistical-analysis-methods.html#spearman-ranked-correlation"><i class="fa fa-check"></i><b>5.2</b> Spearman ranked correlation</a></li>
<li class="chapter" data-level="5.3" data-path="overview-of-statistical-analysis-methods.html"><a href="overview-of-statistical-analysis-methods.html#pathway-analysis"><i class="fa fa-check"></i><b>5.3</b> Pathway analysis</a></li>
<li class="chapter" data-level="5.4" data-path="overview-of-statistical-analysis-methods.html"><a href="overview-of-statistical-analysis-methods.html#pre-computed-feature-associations"><i class="fa fa-check"></i><b>5.4</b> Pre-computed feature associations</a></li>
<li class="chapter" data-level="5.5" data-path="overview-of-statistical-analysis-methods.html"><a href="overview-of-statistical-analysis-methods.html#deconvolution-analysis"><i class="fa fa-check"></i><b>5.5</b> Deconvolution analysis</a></li>
<li class="chapter" data-level="5.6" data-path="overview-of-statistical-analysis-methods.html"><a href="overview-of-statistical-analysis-methods.html#sources-of-gene-annotations-link-to-code-repository"><i class="fa fa-check"></i><b>5.6</b> Sources of gene annotations &amp; link to code repository</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Human Islets</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="overview-of-statistical-analysis-methods" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Overview of statistical analysis methods<a href="overview-of-statistical-analysis-methods.html#overview-of-statistical-analysis-methods" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="multiple-linear-regression" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Multiple linear regression<a href="overview-of-statistical-analysis-methods.html#multiple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Linear models are used to compute omics feature-metadata associations for the bulk RNAseq, Nanostring, pseudobulk RNAseq, and bulk proteomics datasets. A linear model containing the selected metadata variable of interest and all covariates (if any) is fit to the expression or abundance levels of each feature in the selected omics dataset, using the limma R package (version 3.52.4). If the user selects a categorical metadata of interest, two dropdowns automatically appear so that a specific contrast can be specified (ie. ‘type 2 diabetes’ versus ‘no diabetes’). Then, the coefficient of the metadata variable (continuous) or metadata contrast (categorical) of interest and its associated p-value are extracted from the model for each feature. P-values are adjusted using the false discovery rate method. The rationale for using the original limma method is that it has been shown to perform well for many omics types as long as the data are appropriately normalized and transformed. While more customized methods developed for specific omics types may perform slightly better when applied to the appropriate data type, the advantage of our approach is that it can be applied to many omics types without modification, making the results more comparable to each other and making the HumanIslets tool easier to maintain. A detailed explanation of how analyze omics data with multiple linear regression, including how to specify linear models for different research questions and how to interpret the results, is available in Protocol #2 <a href="https://currentprotocols.onlinelibrary.wiley.com/doi/full/10.1002/cpz1.922">here</a>.</p>
</div>
<div id="spearman-ranked-correlation" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Spearman ranked correlation<a href="overview-of-statistical-analysis-methods.html#spearman-ranked-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Due to the highly nonlinear nature of the relationships between single-cell gene expression and single-cell electrophysiology outcomes (patch-seq), Spearman correlation (base R) is used to compute feature-metadata relationships for the patchSeq data. Only single-cell electrophysiology outcomes are available for analysis with the single-cell expression data, and covariate adjustment is not supported. For these analyses, electrophysiology parameters other than the half-inactivation sodium current were normalized to cell size. The sign of the calcium entry, sodium current, and calcium current (early and late) electrophysiology parameters was flipped such that greater values correspond to greater currents. Negative exocytosis values were replaced with zeros.</p>
</div>
<div id="pathway-analysis" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Pathway analysis<a href="overview-of-statistical-analysis-methods.html#pathway-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Overrepresentation analysis (ORA) and gene set enrichment analysis (GSEA) are supported for pathway analysis of the feature association results. Both methods are implemented using the fgsea R package (version 1.22.0). The feature list used for ORA is determined by the p-value threshold specified in the association analysis. GSEA can be performed using either the model coefficient (or log2FC when the metadata is categorical) or the test statistic from the association analysis to rank the features. For the patch-seq data, the coefficient is the correlation estimate and there is no test statistic option as it is not compatible with the Spearman correlation results. There are six supported pathway libraries, including KEGG, Reactome, the full Gene Ontology term list (broken into Biological Process, Cellular Component, and Molecular Function), and the PANTHER summary of the Gene Ontology terms (also broken into the same three categories).</p>
<p>Pathway analysis can sometimes return a high number of significant pathways or gene sets that consist of mostly the same features, leading to a redundant results list. Users have the option of collapsing redundant sets, which uses the “collapsePathways” function within the fgsea R package to filter the gene sets to only include those with independent gene lists. Pathway analysis is not supported for the Nanostring data, as there are too few features (n = 156) for adequate pathway coverage.</p>
</div>
<div id="pre-computed-feature-associations" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Pre-computed feature associations<a href="overview-of-statistical-analysis-methods.html#pre-computed-feature-associations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Associations were computed between all omics feature-metadata variable pairs and between all metadata variable-metadata variable pairs. The linear model and Spearman correlation methods described above were used to compute the omics-metadata associations, with one modification. Some categorical variables have obvious specific contrasts, for example for diabetes status, one is usually interested in type 1 versus no diabetes and type 2 versus no diabetes. In these cases, we specify each contrast of interest using the methods described above. Other variables do not have obvious comparisons, for example donation type, so in this case an ANOVA style analysis is done and the statistics are extracted for the categorical variable coefficient rather than for a specific contrast. Sex, age, BMI, and culture time were included as covariates for analyses that used a linear model (all bulk omics data associations).</p>
<pre><code>Three different methods were used to compute associations between pairs of metadata, depending on whether each metadata in the pair were continuous or categorical. Pearson correlation was used for continuous-continuous pairs, Cramer’s V correlation was used for categorical-categorical pairs, and ANOVA was used for categorical-continuous pairs where the categorical variable is the independent variable and the continuous variable is the dependent variable. Multiple hypothesis correction (FDR method) was performed across all results for the same statistical method. Some metadata variables such as percent purity and percent trapped are in between ordinal variables and a true continuous variable because they are estimates made by eye by a research technician, and the technician tends to estimate whole percentages (ie. 80%, 70%). For simplicity, we treat these as continuous variables. </code></pre>
</div>
<div id="deconvolution-analysis" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Deconvolution analysis<a href="overview-of-statistical-analysis-methods.html#deconvolution-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>After normalization for tissue sample size, the intensity of a marker protein that is only abundant in one cell type and that has relatively constant levels is proportional to the abundance of that cell type. We assume an average of 0.55 beta cells, 0.30 alpha cells, 0.10 delta cells, and 0.05 gamma cells and use this to estimate the cell type composition of each donor using proteomics data. We computed the proportion of each cell type for each donor, according to marker genes. The overall proportion of each cell type was calculated as the median of proportion estimates across all marker genes for that cell type. Finally, the proportion of non-endocrine cells was computed as the remainder after adding the estimated proportion of beta, alpha, delta, and gamma cells and normalizing the endocrine proportions to satisfy an assumed maximum purity of 98%. When computing associations between individual omics features and cell type proportions, endocrine cell proportions were normalized as a proportion of the total endocrine signal and the non-endocrine proportion was included as a covariate to better distinguish cell type-specific signals.</p>
<p>Overall, this can be thought of as estimating the strength of the signal associated with four endocrine cell types, anchoring the median signal strength with prior known cell type proportions, and attributing any missing signal to trapped non-endocrine cells. It relies on the assumptions that marker genes are only expressed in one cell type and that their levels are constant across donors. Neither of these assumptions are completely satisfied, however the method should be a robust estimator so long as the majority of marker genes have heavily biased expression in one cell type and if all marker genes are not regulated in the same direction (ie. all beta cell marker genes up-regulated in donors with diabetes).</p>
</div>
<div id="sources-of-gene-annotations-link-to-code-repository" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Sources of gene annotations &amp; link to code repository<a href="overview-of-statistical-analysis-methods.html#sources-of-gene-annotations-link-to-code-repository" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Entrez IDs, official gene symbols, and short gene descriptions were accessed from NCBI’s FTP site on February 2, 2023 (link <a href="https://ftp.ncbi.nlm.nih.gov/gene/DATA/GENE_INFO/Mammalia/">here</a>), and curated for use throughout the HumanIslets tool. Copies of all associated R scripts, including functions called by the HumanIslets tool, scripts used for data processing and analysis, and scripts for generating manuscript figures are available at this <a href="https://github.com/xia-lab/HumanIsletsR">repository</a>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="overview-of-omics-data-types.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://https://github.com/xia-lab/HumanIsletsDoc/blob/main/04-statistical-analysis-.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
